@model QuizStep.Models.UserModels.MentorTestModel

<div class="col-sm-6 col-md-4 col-lg-3 mt-4">
    <div class="card card-inverse card-info">
        <input type="hidden" value="@Model.Id" name="id" />
        <div class="card-img-container">
            <img class="card-img" src="@Model.Icon" alt="@Model.TestTitle тест зображення">
        </div>
        <div class="card-block">
            <h4 class="ml-2 card-title">@Model.TestTitle</h4>
            <div class="ml-2 mb-2 card-text">
                Створено вами
            </div>
        </div>
        <div class="card-footer d-flex justify-content-between">
            <a class="btn btn-primary" asp-action="EditMentorTest" asp-controller="Account" asp-route-id="@Model.Id"><i class="fa fa-cog"></i></a> @* edit *@
            <a class="btn btn-info" asp-action="" asp-controller="Account"><i class="fa fa-user-plus"></i></a> @* assign *@
            <a class="btn btn-danger" data-toggle="modal" data-target="#confirmDeleteModal" data-id="@Model.TestId"><i class="fa fa-minus-circle"></i></a> @* delete *@
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Delete</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this test?
            </div>
            <div class="modal-footer">
                <input type="hidden" id="testId" name="testId" value="@Model.Id" />
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="deleteTestBtn">Delete</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded",() => {
                const deleteButton = document.getElementById("deleteTestBtn");
                if (!deleteButton) throw "deleteTestBtn not found" ;
                deleteButton.addEventListener("click", deleteButtonClick);
            });
    function deleteButtonClick() {
                const testIdEl = document.getElementById("testId");
                if (!testIdEl) throw "testId input not found";
                const testId = testIdEl.value;
    
                window.fetch("/Account/DeleteTest", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: `testId=${testId}`
                })
                .then(r => r.text())
                .then(t => {
                    if(t === "OK") window.location.reload();
                    else {
                        console.log("failed");
                    }
                });
            }
            
</script>



<style>
    .card-img-container {
        width: 100%; 
        height: 15rem;
        overflow: hidden; 
    }
    
    .card-img {
        width: 100%; 
        height: auto; 
    }
</style>